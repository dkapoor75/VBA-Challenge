Sub Stock_analysis()' Declaring variablesDim Ticker_name As StringDim Ticker_opening_price As DoubleDim Ticker_closing_price As DoubleDim Ticker_yearly_change As DoubleDim Ticker_percent_change As DoubleDim Ticker_total_stock As LongPtrDim Summary_Table_Row As Integer' Looping through all worksheets in the workbookFor Each ws In Worksheets         'Determine the Last Row of the current worksheet         lastrow = ws.Cells(Rows.Count, 1).End(xlUp).Row              'Defining the new columns for summary table        ws.Cells(1, 9).Value = "Ticker"    ws.Cells(1, 10).Value = "Opening Price"    ws.Cells(1, 11).Value = "Closing Price"    ws.Cells(1, 12).Value = "Yearly Change"    ws.Cells(1, 13).Value = "Percent Change"    ws.Cells(1, 14).Value = "Total Stock Volume"         ' Initialising the valtaible to store the the row number for the summary table         Summary_Table_Row = 2         ' looping in the main table         For i = 2 To lastrow             If ws.Cells(i, 1).Value <> ws.Cells(i + 1, 1).Value Then                 ' If the value of the ticker in the next row is different to the curent                    ' Start storing values for this Ticker in valrables as we have to add the record in the summary table                        Ticker_name = ws.Cells(i, 1).Value            Ticker_total_stock = Ticker_total_stock + ws.Cells(i, 7).Value            Ticker_closing_price = ws.Cells(i, 6).Value            Ticker_yearly_change = Ticker_closing_price - Ticker_opening_price            Ticker_percent_change = (Ticker_yearly_change / Ticker_opening_price)                                ' Start writing the values in teh summary table                    ws.Cells(Summary_Table_Row, 9).Value = Ticker_name                        ws.Cells(Summary_Table_Row, 10).Value = Ticker_opening_price                        ws.Cells(Summary_Table_Row, 11).Value = Ticker_closing_price            ws.Cells(Summary_Table_Row, 12).Value = Ticker_yearly_change                    ' conditional formatting fo rthe Yearly change column                        If Ticker_yearly_change < 0 Then                        ' Set the Cell Colours to Red                ws.Cells(Summary_Table_Row, 12).Interior.ColorIndex = 3                    Else                        ' Set the Font Colour to Green                ws.Cells(Summary_Table_Row, 12).Interior.ColorIndex = 4                           End If                    ws.Cells(Summary_Table_Row, 13).NumberFormat = "0.00%"            ws.Cells(Summary_Table_Row, 13).Value = Ticker_percent_change                                    If Ticker_percent_change < 0 Then                        ' Set the Cell Colours to Red                ws.Cells(Summary_Table_Row, 13).Interior.ColorIndex = 3                    Else                        ' Set the Font Colour to Green                ws.Cells(Summary_Table_Row, 13).Interior.ColorIndex = 4                           End If                        ws.Cells(Summary_Table_Row, 14).Value = Ticker_total_stock                      Summary_Table_Row = Summary_Table_Row + 1                    ' For the new ticker about to start from the new record, initialise the total stock value                    Ticker_total_stock = 0                    ' For the new ticker about to start from the new record, Capture the ticker opening price of the new ticker                    Ticker_opening_price = ws.Cells(i + 1, 3).Value                 Else                        ' The next row also has the same ticker                        If i = 2 Then                        ' its the first record of the table                                Ticker_opening_price = ws.Cells(i, 3).Value                    End If                        Ticker_total_stock = Ticker_total_stock + ws.Cells(i, 7).Value             End If         Next i        'Bonus        Dim Greatest_Percent_increase_ticker As String    Dim Greatest_Percent_increase As Double        Dim Greatest_Percent_decrease_ticker As String    Dim Greatest_Percent_decrease As Double        Dim Greatest_Volume_ticker As String    Dim Greatest_Volume As LongPtr        For i = 2 To lastrow             If i = 2 Then            Greatest_Percent_increase = ws.Cells(i, 13).Value            Greatest_Percent_increase_ticker = ws.Cells(i, 9).Value                   Greatest_Percent_decrease = ws.Cells(i, 13).Value            Greatest_Percent_decrease_ticker = ws.Cells(i, 9).Value                   Greatest_Total_Volume = ws.Cells(i, 14).Value            Greatest_Total_Volume_ticker = ws.Cells(i, 14).Value              End If                             If ws.Cells(i + 1, 13).Value > 0 And ws.Cells(i + 1, 13).Value >= Greatest_Percent_increase Then                      Greatest_Percent_increase = ws.Cells(i + 1, 13).Value           Greatest_Percent_increase_ticker = ws.Cells(i + 1, 9).Value                            End If            If ws.Cells(i + 1, 13).Value < 0 And ws.Cells(i + 1, 13).Value < Greatest_Percent_decrease Then            Greatest_Percent_decrease = ws.Cells(i + 1, 13).Value            Greatest_Percent_decrease_ticker = ws.Cells(i + 1, 9).Value                    End If            If ws.Cells(i + 1, 14).Value > 0 And ws.Cells(i + 1, 14).Value >= Greatest_Total_Volume Then                        Greatest_Total_Volume = ws.Cells(i + 1, 14).Value            Greatest_Total_Volume_ticker = ws.Cells(i + 1, 9).Value                        End If        Next i        ws.Cells(1, 18).Value = "Ticker"    ws.Cells(1, 19).Value = "Value"        ws.Cells(2, 17).Value = "Greatest % increase"    ws.Cells(3, 17).Value = "Greatest % decrease"    ws.Cells(4, 17).Value = "Greatest Total Volume"        ws.Cells(2, 18).Value = Greatest_Percent_increase_ticker    ws.Cells(2, 19).Value = Greatest_Percent_increase    ws.Cells(2, 19).NumberFormat = "0.00%"        ws.Cells(3, 18).Value = Greatest_Percent_decrease_ticker    ws.Cells(3, 19).Value = Greatest_Percent_decrease    ws.Cells(3, 19).NumberFormat = "0.00%"        ws.Cells(4, 18).Value = Greatest_Total_Volume_ticker    ws.Cells(4, 19).Value = Greatest_Total_VolumeNext wsEnd Sub